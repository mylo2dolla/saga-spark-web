- generic [ref=e2]:
  - region "Notifications (F8)":
    - list
  - region "Notifications alt+T":
    - list:
      - listitem [ref=e673]:
        - img [ref=e675]
        - generic [ref=e678]: Combat started
  - generic:
    - generic: "Runtime: DEV (development)"
    - generic: "version: 0.0.0"
    - generic: "build: 2026-02-13T03:25:41.607Z"
    - generic: "git: cd67b24"
    - generic: "runId: 752867bb-301c-4df4-9608-ab1067c23d0f"
    - generic: "now: 2026-02-13T03:28:15.813Z"
    - generic: "base: /"
    - generic: "href: http://localhost:8081/login"
  - generic [ref=e26]:
    - complementary [ref=e27]:
      - generic [ref=e28]: Saga Spark
      - navigation [ref=e29]:
        - link "Dashboard" [ref=e30] [cursor=pointer]:
          - /url: /dashboard
        - link "Create/Join" [ref=e31] [cursor=pointer]:
          - /url: /dashboard#create
        - link "Mythic" [ref=e32] [cursor=pointer]:
          - /url: /dashboard#campaigns
        - link "Servers/Admin" [ref=e33] [cursor=pointer]:
          - /url: /servers
    - main [ref=e34]:
      - generic [ref=e35]:
        - generic [ref=e36]:
          - generic [ref=e37]: "Auth: psylus13@gmail.com"
          - generic [ref=e38]: "DB: ok"
        - generic [ref=e39]: /mythic/17496eb8-3ed1-4a9a-ab0d-059bdff54e59
      - generic [ref=e527]:
        - generic [ref=e679]:
          - generic [ref=e680]:
            - generic [ref=e681]: Mythic Weave
            - generic [ref=e682]:
              - text: "Board: combat"
              - generic [ref=e683]: "(last transition: town → combat, encounter)"
          - generic [ref=e684]:
            - button "Dashboard" [ref=e685] [cursor=pointer]
            - button "Refresh" [ref=e686] [cursor=pointer]
            - button "Refresh DM" [ref=e687] [cursor=pointer]
        - generic [ref=e688]:
          - generic [ref=e689]:
            - generic [ref=e690]: Character
            - generic [ref=e691]:
              - generic [ref=e692]: Aria Flux
              - generic [ref=e693]: Time Reaver
            - generic [ref=e694]: Derived Stats (equipment applied)
            - generic [ref=e695]:
              - generic [ref=e696]: "Offense: 53"
              - generic [ref=e697]: "Defense: 43"
              - generic [ref=e698]: "Control: 72"
              - generic [ref=e699]: "Support: 52"
              - generic [ref=e700]: "Mobility: 39"
              - generic [ref=e701]: "Utility: 48"
            - generic [ref=e702]: Skills
            - generic [ref=e703]:
              - generic [ref=e704]:
                - generic [ref=e705]: Chrono Acceleration
                - generic [ref=e706]: passive · self · r0 · cd0
              - generic [ref=e707]:
                - generic [ref=e708]: Temporal Feedback
                - generic [ref=e709]: passive · self · r0 · cd0
              - generic [ref=e710]:
                - generic [ref=e711]: Time Warp
                - generic [ref=e712]: active · tile · r4 · cd2
              - generic [ref=e713]:
                - generic [ref=e714]: Chrono Shield
                - generic [ref=e715]: active · self · r0 · cd3
              - generic [ref=e716]:
                - generic [ref=e717]: Time Bomb
                - generic [ref=e718]: active · single · r5 · cd1
              - generic [ref=e719]:
                - generic [ref=e720]: Temporal Distortion
                - generic [ref=e721]: active · area · r4 · cd3
          - generic [ref=e722]:
            - generic [ref=e723]: Board State (authoritative)
            - generic [ref=e725]: "{ \"grid\": { \"width\": 12, \"height\": 8 }, \"seed\": 1220838576, \"blocked_tiles\": [ { \"x\": 6, \"y\": 4 }, { \"x\": 5, \"y\": 2 }, { \"x\": 5, \"y\": 3 } ], \"combat_session_id\": \"b9319b5d-c649-4ff0-96c8-5cd3b0aa1176\" }"
            - generic [ref=e726]: "UI contract: board + transitions + action_events are sufficient for deterministic replay. (bootstrapped)"
        - generic [ref=e727]:
          - generic [ref=e728]:
            - generic [ref=e729]: Progression
            - generic [ref=e730]:
              - generic [ref=e731]: "Level: 1"
              - generic [ref=e732]: "Unspent Points: 0"
              - generic [ref=e733]: "XP: 0"
              - generic [ref=e734]: "XP to Next: 300"
            - generic [ref=e735]:
              - button "+250 XP" [ref=e736] [cursor=pointer]
              - button "Generate Loot" [ref=e737] [cursor=pointer]
              - button "Recompute" [ref=e738] [cursor=pointer]
            - generic [ref=e739]: Recent Progression Events
            - generic [ref=e741]: No progression events yet.
          - generic [ref=e742]:
            - generic [ref=e743]: Skill Loadout
            - generic [ref=e744]: "Slots unlocked: 2 · Selected: 2"
            - generic [ref=e745]:
              - textbox "Loadout name" [ref=e746]: Default
              - generic [ref=e747]:
                - button "Random" [ref=e748] [cursor=pointer]:
                  - img
                  - text: Random
                - button "Expand" [ref=e749] [cursor=pointer]:
                  - img
                  - text: Expand
            - generic [ref=e750]:
              - button "Time Warp" [ref=e751] [cursor=pointer]
              - button "Chrono Shield" [ref=e752] [cursor=pointer]
              - button "Time Bomb" [ref=e753] [cursor=pointer]
              - button "Temporal Distortion" [ref=e754] [cursor=pointer]
              - button "Weakness Exploit" [ref=e755] [cursor=pointer]
              - button "Temporal Reckoning" [ref=e756] [cursor=pointer]
            - button "Save + Activate" [ref=e758] [cursor=pointer]
            - generic [ref=e759]: Saved Loadouts
            - generic [ref=e761]: No saved loadouts.
        - generic [ref=e762]:
          - generic [ref=e764]: Board Summary
          - generic [ref=e766]: Board Actions
        - generic [ref=e767]:
          - generic [ref=e768]:
            - generic [ref=e769]: Combat Playback (DB is truth)
            - generic [ref=e770]: active
          - generic [ref=e771]:
            - generic [ref=e772]:
              - generic [ref=e774]: Combat
              - generic [ref=e775]: "Turn: Ink Ghoul 2"
              - generic [ref=e776]:
                - button "Ink Ghoul 2 npc · (8,2) · armor 0 100/100" [ref=e777] [cursor=pointer]:
                  - generic [ref=e778]:
                    - generic [ref=e779]:
                      - generic [ref=e780]: Ink Ghoul 2
                      - generic [ref=e781]: npc · (8,2) · armor 0
                    - generic [ref=e785]: 100/100
                - button "Ink Ghoul 3 npc · (9,3) · armor 0 100/100" [ref=e786] [cursor=pointer]:
                  - generic [ref=e787]:
                    - generic [ref=e788]:
                      - generic [ref=e789]: Ink Ghoul 3
                      - generic [ref=e790]: npc · (9,3) · armor 0
                    - generic [ref=e794]: 100/100
                - button "Ink Ghoul 1 npc · (9,1) · armor 0 100/100" [ref=e795] [cursor=pointer]:
                  - generic [ref=e796]:
                    - generic [ref=e797]:
                      - generic [ref=e798]: Ink Ghoul 1
                      - generic [ref=e799]: npc · (9,1) · armor 0
                    - generic [ref=e803]: 100/100
                - button "Ink Ghoul 4 npc · (8,4) · armor 0 100/100" [ref=e804] [cursor=pointer]:
                  - generic [ref=e805]:
                    - generic [ref=e806]:
                      - generic [ref=e807]: Ink Ghoul 4
                      - generic [ref=e808]: npc · (8,4) · armor 0
                    - generic [ref=e812]: 100/100
                - button "Aria Flux player · (1,1) · armor 0 101/101" [ref=e813] [cursor=pointer]:
                  - generic [ref=e814]:
                    - generic [ref=e815]:
                      - generic [ref=e816]: Aria Flux
                      - generic [ref=e817]: player · (1,1) · armor 0
                    - generic [ref=e821]: 101/101
              - generic [ref=e822]: Action Log (append-only)
              - generic [ref=e823]:
                - generic [ref=e824]: "t0: combat_start"
                - generic [ref=e825]: "t0: round_start"
                - generic [ref=e826]: "t0: turn_start"
            - generic [ref=e827]:
              - generic [ref=e828]: Grid (truth)
              - generic [ref=e830]:
                - button "0,0" [ref=e831] [cursor=pointer]
                - button "1,0" [ref=e832] [cursor=pointer]
                - button "2,0" [ref=e833] [cursor=pointer]
                - button "3,0" [ref=e834] [cursor=pointer]
                - button "4,0" [ref=e835] [cursor=pointer]
                - button "5,0" [ref=e836] [cursor=pointer]
                - button "6,0" [ref=e837] [cursor=pointer]
                - button "7,0" [ref=e838] [cursor=pointer]
                - button "8,0" [ref=e839] [cursor=pointer]
                - button "9,0" [ref=e840] [cursor=pointer]
                - button "10,0" [ref=e841] [cursor=pointer]
                - button "0,1" [ref=e842] [cursor=pointer]
                - button "AR" [ref=e843] [cursor=pointer]
                - button "2,1" [ref=e844] [cursor=pointer]
                - button "3,1" [ref=e845] [cursor=pointer]
                - button "4,1" [ref=e846] [cursor=pointer]
                - button "5,1" [ref=e847] [cursor=pointer]
                - button "6,1" [ref=e848] [cursor=pointer]
                - button "7,1" [ref=e849] [cursor=pointer]
                - button "8,1" [ref=e850] [cursor=pointer]
                - button "IN" [ref=e851] [cursor=pointer]
                - button "10,1" [ref=e852] [cursor=pointer]
                - button "0,2" [ref=e853] [cursor=pointer]
                - button "1,2" [ref=e854] [cursor=pointer]
                - button "2,2" [ref=e855] [cursor=pointer]
                - button "3,2" [ref=e856] [cursor=pointer]
                - button "4,2" [ref=e857] [cursor=pointer]
                - button "5,2" [ref=e858] [cursor=pointer]
                - button "6,2" [ref=e859] [cursor=pointer]
                - button "7,2" [ref=e860] [cursor=pointer]
                - button "IN" [ref=e861] [cursor=pointer]
                - button "9,2" [ref=e862] [cursor=pointer]
                - button "10,2" [ref=e863] [cursor=pointer]
                - button "0,3" [ref=e864] [cursor=pointer]
                - button "1,3" [ref=e865] [cursor=pointer]
                - button "2,3" [ref=e866] [cursor=pointer]
                - button "3,3" [ref=e867] [cursor=pointer]
                - button "4,3" [ref=e868] [cursor=pointer]
                - button "5,3" [ref=e869] [cursor=pointer]
                - button "6,3" [ref=e870] [cursor=pointer]
                - button "7,3" [ref=e871] [cursor=pointer]
                - button "8,3" [ref=e872] [cursor=pointer]
                - button "IN" [ref=e873] [cursor=pointer]
                - button "10,3" [ref=e874] [cursor=pointer]
                - button "0,4" [ref=e875] [cursor=pointer]
                - button "1,4" [ref=e876] [cursor=pointer]
                - button "2,4" [ref=e877] [cursor=pointer]
                - button "3,4" [ref=e878] [cursor=pointer]
                - button "4,4" [ref=e879] [cursor=pointer]
                - button "5,4" [ref=e880] [cursor=pointer]
                - button "6,4" [ref=e881] [cursor=pointer]
                - button "7,4" [ref=e882] [cursor=pointer]
                - button "IN" [ref=e883] [cursor=pointer]
                - button "9,4" [ref=e884] [cursor=pointer]
                - button "10,4" [ref=e885] [cursor=pointer]
                - button "0,5" [ref=e886] [cursor=pointer]
                - button "1,5" [ref=e887] [cursor=pointer]
                - button "2,5" [ref=e888] [cursor=pointer]
                - button "3,5" [ref=e889] [cursor=pointer]
                - button "4,5" [ref=e890] [cursor=pointer]
                - button "5,5" [ref=e891] [cursor=pointer]
                - button "6,5" [ref=e892] [cursor=pointer]
                - button "7,5" [ref=e893] [cursor=pointer]
                - button "8,5" [ref=e894] [cursor=pointer]
                - button "9,5" [ref=e895] [cursor=pointer]
                - button "10,5" [ref=e896] [cursor=pointer]
                - button "0,6" [ref=e897] [cursor=pointer]
                - button "1,6" [ref=e898] [cursor=pointer]
                - button "2,6" [ref=e899] [cursor=pointer]
                - button "3,6" [ref=e900] [cursor=pointer]
                - button "4,6" [ref=e901] [cursor=pointer]
                - button "5,6" [ref=e902] [cursor=pointer]
                - button "6,6" [ref=e903] [cursor=pointer]
                - button "7,6" [ref=e904] [cursor=pointer]
                - button "8,6" [ref=e905] [cursor=pointer]
                - button "9,6" [ref=e906] [cursor=pointer]
                - button "10,6" [ref=e907] [cursor=pointer]
              - generic [ref=e908]: Your Skills
              - generic [ref=e909]:
                - button "Time Warp active · tile · r4 · cd2" [ref=e910] [cursor=pointer]:
                  - generic [ref=e911]: Time Warp
                  - generic [ref=e912]: active · tile · r4 · cd2
                - button "Chrono Shield active · self · r0 · cd3" [ref=e913] [cursor=pointer]:
                  - generic [ref=e914]: Chrono Shield
                  - generic [ref=e915]: active · self · r0 · cd3
                - button "Time Bomb active · single · r5 · cd1" [ref=e916] [cursor=pointer]:
                  - generic [ref=e917]: Time Bomb
                  - generic [ref=e918]: active · single · r5 · cd1
                - button "Temporal Distortion active · area · r4 · cd3" [ref=e919] [cursor=pointer]:
                  - generic [ref=e920]: Temporal Distortion
                  - generic [ref=e921]: active · area · r4 · cd3
                - button "Weakness Exploit active · single · r3 · cd2" [ref=e922] [cursor=pointer]:
                  - generic [ref=e923]: Weakness Exploit
                  - generic [ref=e924]: active · single · r3 · cd2
                - button "Temporal Reckoning ultimate · area · r5 · cd5" [ref=e925] [cursor=pointer]:
                  - generic [ref=e926]: Temporal Reckoning
                  - generic [ref=e927]: ultimate · area · r5 · cd5
              - generic [ref=e928]:
                - button "Waiting for Your Turn" [disabled]
                - button "Clear" [ref=e929] [cursor=pointer]
                - button "Advancing..." [disabled]
              - generic [ref=e930]: Select a skill, then select a target combatant. Range and turn ownership are enforced by the combat engine.
        - generic [ref=e932]:
          - generic [ref=e933]: Inventory + Equipment
          - generic [ref=e934]: Equipment bonuses are applied in real time. Rings/trinkets stack with no limit.
          - generic [ref=e935]:
            - generic [ref=e936]: Equipped Bonuses
            - generic [ref=e937]: None
          - generic [ref=e938]:
            - generic [ref=e939]:
              - generic [ref=e940]: Equipment
              - generic [ref=e942]: No equipped items.
            - generic [ref=e943]:
              - generic [ref=e944]: Backpack
              - generic [ref=e946]: Backpack is empty.
        - generic [ref=e947]:
          - generic [ref=e948]: Recent Board Transitions (append-only)
          - generic [ref=e949]: "[ { \"id\": \"032c4d23-27c4-463e-864d-fa78aedd766a\", \"campaign_id\": \"17496eb8-3ed1-4a9a-ab0d-059bdff54e59\", \"from_board_type\": \"town\", \"to_board_type\": \"combat\", \"reason\": \"encounter\", \"animation\": \"page_turn\", \"payload_json\": { \"combat_session_id\": \"b9319b5d-c649-4ff0-96c8-5cd3b0aa1176\" }, \"created_at\": \"2026-02-13T03:41:10.878882+00:00\" } ]"
        - generic [ref=e950]:
          - generic [ref=e951]:
            - generic [ref=e952]: DM Context (from mythic.v_*_for_dm + canonical rules/script)
            - generic [ref=e953]: loading...
          - generic [ref=e954]: "{ \"ok\": true, \"campaign_id\": \"17496eb8-3ed1-4a9a-ab0d-059bdff54e59\", \"player_id\": \"316225c3-b052-4e4b-bb01-991ff577c037\", \"board\": { \"campaign_id\": \"17496eb8-3ed1-4a9a-ab0d-059bdff54e59\", \"board_id\": \"bac7c748-a16f-4bcc-bea4-df2af576b9ec\", \"board_type\": \"town\", \"status\": \"active\", \"state_json\": { \"seed\": 765883371, \"gossip\": [], \"rumors\": [], \"vendors\": [ { \"id\": \"vendor_1\", \"name\": \"Blackport\", \"services\": [ \"heal\", \"enchant\" ] }, { \"id\": \"vendor_2\", \"name\": \"Dusport\", \"services\": [ \"potions\", \"bombs\" ] }, { \"id\": \"vendor_3\", \"name\": \"Duscross\", \"services\": [ \"potions\", \"bombs\" ] } ], \"bounties\": [], \"services\": [ \"inn\", \"healer\", \"notice_board\" ], \"guard_alertness\": 0.3, \"factions_present\": [], \"consequence_flags\": {} }, \"ui_hints_json\": { \"camera\": { \"x\": 0, \"y\": 0, \"zoom\": 1 } }, \"active_scene_id\": null, \"combat_session_id\": null, \"updated_at\": \"2026-02-13T03:32:29.115039+00:00\", \"recent_transitions\": null }, \"character\": { \"character_id\": \"59f70e86-bcae-4729-b35e-c6798f051f84\", \"campaign_id\": \"17496eb8-3ed1-4a9a-ab0d-059bdff54e59\", \"player_id\": \"316225c3-b052-4e4b-bb01-991ff577c037\", \"name\": \"Aria Flux\", \"level\": 1, \"base_stats\": { \"control\": 72, \"defense\": 43, \"offense\": 53, \"support\": 52, \"utility\": 48, \"mobility\": 39 }, \"class_json\": { \"role\": \"controller\", \"seed\": 49500599, \"concept\": \"chrono witch gunslinger\", \"weakness\": { \"id\": \"telegraphed_power\", \"counterplay\": \"Lure enemies into a trap, then strike when they least expect it. *CLICK-CLACK*\", \"description\": \"Your time-bending attacks are flashy and attention-grabbing, making them easy to anticipate and counter. Enemies can dodge or punish you if you're too predictable.\" }, \"class_name\": \"Time Reaver\", \"weapon_identity\": { \"notes\": \"Favors mystical, high-tech firearms that can pierce the fabric of time.\", \"family\": \"ranged\" }, \"class_description\": \"A chrono witch gunslinger who weaves time and space to outmaneuver foes, dealing devastating ranged attacks and manipulating the battlefield with cunning and magical prowess. *BAM* *WHOOSH*\" }, \"resources\": { \"bars\": [ { \"id\": \"mana\", \"max\": 100, \"name\": \"MANA\", \"tags\": [ \"mana\" ], \"current\": 50, \"regen_per_turn\": 8 } ], \"primary_id\": \"mana\" }, \"derived_json\": { \"max_hp\": 101.6212, \"resist\": 0, \"crit_mult\": 2.005, \"crit_chance\": 0.2375, \"armor_rating\": 1.43, \"attack_rating\": 1.53, \"max_power_bar\": 50.74896, \"equipment_mods\": { \"resist\": 0, \"control\": 0, \"defense\": 0, \"offense\": 0, \"support\": 0, \"utility\": 0, \"mobility\": 0, \"armor_power\": 0, \"weapon_power\": 0 } }, \"skills\": [ { \"id\": \"66075dbd-8a48-400d-ada2-16542653c0dc\", \"kind\": \"active\", \"name\": \"Temporal Distortion\", \"cost_json\": { \"type\": \"flat\", \"when\": \"on_cast\", \"amount\": 18, \"resource_id\": \"mana\" }, \"targeting\": \"area\", \"counterplay\": { \"notes\": \"Resolve/resist reduces chance.\", \"resisted_by\": [ \"resolve\" ] }, \"description\": \"Create a localized temporal distortion, stunning enemies and disrupting their actions. *ZZT*\", \"range_tiles\": 4, \"effects_json\": { \"tags\": [ \"control\" ], \"status\": { \"id\": \"stun\", \"stacking\": \"none\", \"duration_turns\": 1 }, \"apply_chance\": { \"uses\": [ \"control\", \"utility\" ], \"function\": \"mythic.status_apply_chance\" } }, \"scaling_json\": { \"curve\": \"power_at_level\", \"scales_with\": [ \"control\", \"utility\" ] }, \"cooldown_turns\": 3, \"targeting_json\": { \"shape\": \"area\", \"metric\": \"manhattan\", \"radius\": 1, \"requires_los\": false, \"friendly_fire\": false, \"blocks_on_walls\": true }, \"narration_style\": \"comic-brutal\" }, { \"id\": \"8ed37cd4-6f8a-4e7f-a6d3-6da684bb1797\", \"kind\": \"active\", \"name\": \"Weakness Exploit\", \"cost_json\": { \"type\": \"flat\", \"when\": \"on_cast\", \"amount\": 10, \"resource_id\": \"mana\" }, \"targeting\": \"single\", \"counterplay\": { \"notes\": \"Self-exposure invites punishment.\", \"punished_by\": [ \"focus_fire\" ] }, \"description\": \"Exploit the enemy's weakness, dealing bonus damage and increasing your critical hit chance. *CLICK-CLACK*\", \"range_tiles\": 3, \"effects_json\": { \"tags\": [ \"utility\" ], \"bonus\": { \"note\": \"High reward, self-exposure.\", \"crit_chance_add\": 0.12 }, \"self_debuff\": { \"id\": \"telegraphed_power\", \"intensity\": 1, \"duration_turns\": 1 }, \"onomatopoeia\": \"CLICK-CLACK!\" }, \"scaling_json\": { \"curve\": \"power_at_level\", \"scales_with\": [ \"utility\", \"mobility\" ] }, \"cooldown_turns\": 2, \"targeting_json\": { \"shape\": \"single\", \"metric\": \"manhattan\", \"requires_los\": true }, \"narration_style\": \"comic-brutal\" }, { \"id\": \"79aabf5d-c0b3-4340-8883-63ae48053072\", \"kind\": \"active\", \"name\": \"Time Warp\", \"cost_json\": { \"type\": \"flat\", \"when\": \"on_cast\", \"amount\": 10, \"resource_id\": \"mana\" }, \"targeting\": \"tile\", \"counterplay\": { \"notes\": \"Root/stun stops reposition.\", \"avoided_by\": [ \"root\" ] }, \"description\": \"Dash through time and space, repositioning yourself quickly and avoiding attacks. *WHOOSH*\", \"range_tiles\": 4, \"effects_json\": { \"move\": { \"dash_tiles\": 3 }, \"tags\": [ \"movement\" ], \"onomatopoeia\": \"WHOOSH!\" }, \"scaling_json\": { \"curve\": \"power_at_level\", \"scales_with\": [ \"mobility\" ] }, \"cooldown_turns\": 2, \"targeting_json\": { \"shape\": \"line\", \"width\": 1, \"length\": 4, \"metric\": \"manhattan\", \"requires_los\": false, \"friendly_fire\": false, \"blocks_on_walls\": true }, \"narration_style\": \"comic-brutal\" }, { \"id\": \"93729314-6881-4966-afc5-0737ee6a4a12\", \"kind\": \"active\", \"name\": \"Chrono Shield\", \"cost_json\": { \"type\": \"flat\", \"when\": \"on_cast\", \"amount\": 12, \"resource_id\": \"mana\" }, \"targeting\": \"self\", \"counterplay\": { \"notes\": \"Piercing attacks reduce barrier.\", \"countered_by\": [ \"pierce\", \"dispel\" ] }, \"description\": \"Summon a temporal barrier, absorbing damage and protecting yourself from harm. *THUD*\", \"range_tiles\": 0, \"effects_json\": { \"tags\": [ \"defense\" ], \"barrier\": { \"amount\": 20, \"duration_turns\": 2 }, \"weakness_hook\": \"telegraphed_power\" }, \"scaling_json\": { \"curve\": \"power_at_level\", \"scales_with\": [ \"defense\", \"support\" ] }, \"cooldown_turns\": 3, \"targeting_json\": { \"shape\": \"self\", \"metric\": \"manhattan\" }, \"narration_style\": \"comic-brutal\" }, { \"id\": \"eea05222-5c97-491e-ac02-2e5fbdb077b3\", \"kind\": \"active\", \"name\": \"Time Bomb\", \"cost_json\": { \"type\": \"flat\", \"when\": \"on_cast\", \"amount\": 15, \"resource_id\": \"mana\" }, \"targeting\": \"single\", \"counterplay\": { \"notes\": \"Telegraphed burst can be punished.\", \"avoided_by\": [ \"dodge\", \"block\" ] }, \"description\": \"Unleash a burst of temporal energy, dealing massive damage to a single target. *KABOOM*\", \"range_tiles\": 5, \"effects_json\": { \"gore\": true, \"tags\": [ \"burst\" ], \"damage\": { \"tags\": [ \"ranged\", \"physical\" ], \"skill_mult\": 1.35 } }, \"scaling_json\": { \"curve\": \"power_at_level\", \"scales_with\": [ \"offense\" ] }, \"cooldown_turns\": 1, \"targeting_json\": { \"shape\": \"single\", \"metric\": \"manhattan\", \"requires_los\": true }, \"narration_style\": \"comic-brutal\" }, { \"id\": \"62bbd5d6-198a-41b2-9fa3-d0be58b97216\", \"kind\": \"passive\", \"name\": \"Chrono Acceleration\", \"cost_json\": {}, \"targeting\": \"self\", \"counterplay\": { \"notes\": \"Passive power is consistent but not explosive.\", \"countered_by\": [ \"dispel\", \"burst\" ] }, \"description\": \"Your temporal magic accelerates your offense, granting a consistent damage boost. *ZZT*\", \"range_tiles\": 0, \"effects_json\": { \"tags\": [ \"passive\" ], \"bonuses\": [ { \"add\": 6, \"stat\": \"offense\" } ] }, \"scaling_json\": { \"curve\": \"power_at_level\", \"scales_with\": [ \"offense\" ] }, \"cooldown_turns\": 0, \"targeting_json\": { \"shape\": \"self\", \"metric\": \"manhattan\" }, \"narration_style\": \"comic-brutal\" }, { \"id\": \"638be57e-fc61-4649-9042-7a3452c782f1\", \"kind\": \"passive\", \"name\": \"Temporal Feedback\", \"cost_json\": {}, \"targeting\": \"self\", \"counterplay\": { \"notes\": \"Shuts off if the enemy plays clean.\", \"countered_by\": [ \"deny_triggers\" ] }, \"description\": \"Your time magic reacts to critical hits, kills, and blocks, granting a weakness hook that can be exploited by enemies. *FWIP*\", \"range_tiles\": 0, \"effects_json\": { \"tags\": [ \"passive\" ], \"triggers\": [ \"on_crit\", \"on_kill\", \"on_block\" ], \"weakness_hook\": \"telegraphed_power\" }, \"scaling_json\": { \"curve\": \"power_at_level\", \"scales_with\": [ \"utility\" ] }, \"cooldown_turns\": 0, \"targeting_json\": { \"shape\": \"self\", \"metric\": \"manhattan\" }, \"narration_style\": \"comic-brutal\" }, { \"id\": \"88ac706c-2e07-4548-a822-0bae0f378341\", \"kind\": \"ultimate\", \"name\": \"Temporal Reckoning\", \"cost_json\": { \"type\": \"flat\", \"when\": \"on_cast\", \"amount\": 40, \"resource_id\": \"mana\" }, \"targeting\": \"area\", \"counterplay\": { \"notes\": \"Cone/area can be dodged by positioning.\", \"avoided_by\": [ \"spread_out\" ] }, \"description\": \"Unleash a devastating temporal blast, dealing massive damage to all enemies in the area and applying a weakness debuff. *KRA-KADOOM!!*\", \"range_tiles\": 5, \"effects_json\": { \"tags\": [ \"ultimate\" ], \"damage\": { \"tags\": [ \"ranged\", \"finisher\" ], \"skill_mult\": 2.2 }, \"drawback\": { \"id\": \"telegraphed_power\", \"intensity\": 2, \"duration_turns\": 2 }, \"onomatopoeia\": \"KRA-KADOOM!!\", \"world_reaction\": { \"note\": \"The DM notices. Factions notice. The world notices.\" } }, \"scaling_json\": { \"curve\": \"power_at_level\", \"scales_with\": [ \"offense\", \"utility\" ] }, \"cooldown_turns\": 5, \"targeting_json\": { \"shape\": \"cone\", \"width\": 3, \"length\": 5, \"metric\": \"manhattan\", \"requires_los\": false, \"friendly_fire\": false, \"blocks_on_walls\": true }, \"narration_style\": \"comic-brutal\" } ], \"items\": null }, \"combat\": null, \"rules\": { \"name\": \"mythic-weave-rules-v1\", \"version\": 4, \"rules\": { \"rng\": { \"rng01\": \"mythic.rng01(seed,label)\", \"rng_int\": \"mythic.rng_int(seed,label,lo,hi)\", \"rng_pick\": \"mythic.rng_pick(seed,label,arr)\", \"determinism\": { \"rule\": \"All randomness is derived from seed + label via mythic.rng* functions.\", \"seed_sources\": { \"loot\": \"combat_sessions.seed or board seed\", \"board\": \"mythic.boards.state_json.seed (or campaign seed if absent)\", \"world\": \"campaign seed + scene seed\", \"combat\": \"mythic.combat_sessions.seed\" } }, \"label_conventions\": { \"loot\": [ \"loot:{rarity}:{slot}:{weapon_family}\", \"affix:{i}\", \"drawback:{i}\" ], \"world\": [ \"board:{board_type}\", \"scene:{scene_id}\", \"faction:{faction_id}\", \"revenge_arc:{arc_id}\" ], \"combat\": [ \"combat:{combat_session_id}\", \"turn:{turn_index}\", \"actor:{combatant_id}\", \"skill:{skill_id}\", \"target:{combatant_id_or_tile}\" ], \"global\": [ \"component:purpose\", \"component:purpose:subpurpose\" ] } }, \"roles\": { \"kit_tags\": [ \"movement\", \"defense\", \"burst\", \"control\", \"support\", \"utility\", \"summon\", \"curse\", \"trap\", \"stealth\", \"heal\", \"shield\", \"stance\", \"combo\" ], \"definitions\": { \"dps\": { \"primary\": [ \"offense\", \"mobility\" ], \"fails_if\": [ \"no counterplay/weakness\", \"no positional or timing rule\" ], \"secondary\": [ \"utility\" ], \"kit_must_include\": [ \"burst\", \"sustained_damage\", \"escape_or_iframes\" ] }, \"tank\": { \"primary\": [ \"defense\", \"support\" ], \"fails_if\": [ \"no survivability loop\", \"no way to influence enemy targeting\" ], \"secondary\": [ \"control\" ], \"kit_must_include\": [ \"mitigation\", \"threat_or_zone_control\", \"recovery_or_barrier\" ] }, \"hybrid\": { \"primary\": [ \"mixed\" ], \"fails_if\": [ \"kit lacks identity\" ], \"secondary\": [ \"mixed\" ], \"kit_must_include\": [ \"two_roles_supported\", \"clear_identity_hook\" ] }, \"support\": { \"primary\": [ \"support\", \"utility\" ], \"fails_if\": [ \"no team-facing impact\" ], \"secondary\": [ \"control\" ], \"kit_must_include\": [ \"ally_sustain\", \"buff_or_cleanse\", \"tempo_shift\" ] }, \"controller\": { \"primary\": [ \"control\", \"utility\" ], \"fails_if\": [ \"no resist/counterplay hooks\", \"cc is unavoidable\" ], \"secondary\": [ \"support\" ], \"kit_must_include\": [ \"hard_cc\", \"soft_cc\", \"counterplay_hooks\" ] }, \"skirmisher\": { \"primary\": [ \"mobility\", \"offense\" ], \"fails_if\": [ \"no positional rule\" ], \"secondary\": [ \"utility\" ], \"kit_must_include\": [ \"reposition\", \"pick_tool\", \"disengage\" ] } }, \"kit_requirements\": { \"actives\": { \"max\": 6, \"min\": 4 }, \"passives\": { \"max\": 4, \"min\": 2 }, \"ultimate\": { \"count\": 1 }, \"must_include\": [ \"movement_or_reposition\", \"defense_or_mitigation\", \"burst_or_finisher\", \"control_or_disrupt\", \"utility_or_support\" ], \"weakness_by_design\": { \"counterplay_required\": true, \"embedded_in_skills_min\": 2, \"must_define_in_class_json\": true, \"legendary_plus_drawback_must_reference\": true } } }, \"boards\": { \"types\": [ \"town\", \"dungeon\", \"travel\", \"combat\" ], \"board_row\": \"mythic.boards\", \"replay_rule\": \"boards + board_transitions + action_events are sufficient to deterministically replay the session UI.\", \"transition_log\": \"mythic.board_transitions\", \"state_contracts\": { \"town\": { \"includes\": [ \"vendors\", \"services\", \"gossip\", \"factions_present\", \"guard_alertness\", \"bounties\", \"rumors\", \"consequence_flags\" ] }, \"combat\": { \"includes\": [ \"combat_session_id\", \"grid\", \"turn_order\", \"hazards\", \"cover\" ] }, \"travel\": { \"includes\": [ \"route_segments\", \"hazard_meter\", \"scouting\", \"weather\", \"encounter_seeds\", \"supply_pressure\" ] }, \"dungeon\": { \"includes\": [ \"room_graph\", \"fog_of_war\", \"trap_signals\", \"loot_nodes\", \"faction_presence\", \"noise_meter\" ] } }, \"transition_triggers\": [ { \"if\": \"encounter_started\", \"then\": \"combat\" }, { \"if\": \"combat_ended\", \"then\": \"return_to_previous_board\" }, { \"if\": \"travel_arrival.location_type in (town,city,village)\", \"then\": \"town\" }, { \"if\": \"travel_arrival.location_type in (dungeon,cave,ruins,stronghold,temple)\", \"then\": \"dungeon\" }, { \"else\": \"travel\" } ], \"transition_animation\": \"page_turn\", \"transition_payload_contract\": { \"required\": [ \"reason\" ], \"animation\": \"page_turn\", \"recommended\": [ \"from_board_id\", \"to_board_id\", \"combat_session_id\", \"return_to_board_type\", \"return_to_board_id\", \"delta\" ] } }, \"version\": 3, \"factions\": { \"tiers\": { \"ally\": 600, \"hunted\": -600, \"hostile\": -250, \"neutral\": 0, \"friendly\": 250 }, \"behaviors\": { \"ally\": [ \"discounts\", \"backup in fights\", \"cover-ups\", \"safehouse access\" ], \"hunted\": [ \"hit squads\", \"asset targeting\", \"nemesis escalation\", \"towns lock down\" ], \"hostile\": [ \"refuse service\", \"ambush risk\", \"bounties\", \"sabotage\" ], \"neutral\": [ \"normal prices\", \"gossip\", \"watchful guards\" ], \"friendly\": [ \"minor discounts\", \"tips\", \"warnings\", \"rumors\" ] }, \"rep_drift\": { \"rule\": \"Reputation drifts toward 0 unless reinforced by events. App calls this nightly.\", \"function\": \"mythic.rep_drift(current_rep, drift_per_day)\", \"default_drift_per_day\": 2 }, \"rep_range\": { \"max\": 1000, \"min\": -1000 }, \"revenge_arcs\": { \"create_when\": [ { \"if\": \"severity>=4 and delta<=-80\", \"then\": \"create_or_escalate_arc\" }, { \"if\": \"rep<=-600\", \"then\": \"create_or_escalate_arc\" }, { \"if\": \"repeated_kills>=3 in 24h\", \"then\": \"create_or_escalate_arc\" } ], \"nemesis_behaviors\": [ \"learns tactics\", \"targets assets\", \"schedules ambushes\", \"counterbuilds player signatures\" ], \"nemesis_json_contract\": { \"name\": \"string\", \"title\": \"string\", \"grudge\": \"object\", \"loadout\": \"object\", \"tactics\": \"array\", \"faction_style\": \"string\", \"strike_schedule\": \"object\", \"signature_counter\": \"object\" } }, \"reputation_events\": { \"append_only\": true, \"severity_range\": { \"max\": 5, \"min\": 1 }, \"evidence_contract\": { \"proof\": \"object\", \"scene_id\": \"uuid|null\", \"witnesses\": \"array\", \"board_type\": \"town|dungeon|travel|combat\" } } }, \"leveling\": { \"level_cap\": 99, \"power_curve\": { \"function\": \"mythic.power_at_level(lvl int)\", \"interpolation\": \"exp\", \"power_level_1\": 1, \"power_level_99\": 1000000 } }, \"dm_entity\": { \"mood\": { \"menace\": { \"max\": 1, \"min\": 0, \"default\": 0.35 }, \"boredom\": { \"max\": 1, \"min\": 0, \"default\": 0.2 }, \"respect\": { \"max\": 1, \"min\": 0, \"default\": 0.25 }, \"amusement\": { \"max\": 1, \"min\": 0, \"default\": 0.4 }, \"irritation\": { \"max\": 1, \"min\": 0, \"default\": 0.2 } }, \"sliders\": { \"cruelty\": { \"max\": 1, \"min\": 0, \"default\": 0.55 }, \"honesty\": { \"max\": 1, \"min\": 0, \"default\": 0.55 }, \"favoritism\": { \"max\": 1, \"min\": 0, \"default\": 0.5 }, \"playfulness\": { \"max\": 1, \"min\": 0, \"default\": 0.65 }, \"intervention\": { \"max\": 1, \"min\": 0, \"default\": 0.4 } }, \"learning\": { \"inputs\": [ \"dm_memory_events\", \"dm_player_model\", \"dm_world_tension\", \"reputation_events\", \"loot rarity\", \"combat patterns\" ], \"outputs\": [ \"encounter composition\", \"enemy adaptation\", \"trap evolution\", \"loot drift\", \"faction behaviors\", \"board transition frequency\", \"narration tone\" ], \"player_model_fields\": [ \"cruelty_score\", \"heroism_score\", \"cunning_score\", \"chaos_score\", \"honor_score\", \"greed_score\", \"boredom_signals\", \"exploit_signals\", \"preferred_tactics\" ] }, \"tone_rules\": { \"may_taunt\": true, \"disallowed\": [ \"hate slurs\", \"sexual content\", \"sexual violence\" ], \"not_neutral\": true, \"never_sexual\": true, \"allowable_insults\": [ \"idiot\", \"moron\", \"clown\", \"gremlin\", \"menace\", \"disaster\", \"little goblin\" ], \"may_lie_by_omission\": true, \"violence_not_sanitized\": true }, \"mood_effects\": { \"menace_high\": [ \"increase lethality\", \"more brutal descriptions\", \"harsher consequences\" ], \"boredom_high\": [ \"increase spectacle\", \"escalate stakes\", \"spawn ambushes\" ], \"respect_high\": [ \"smarter counters\", \"fewer cheap shots\", \"more mind games\" ], \"amusement_high\": [ \"more jokes\", \"weirder loot\", \"comic timing\" ], \"irritation_high\": [ \"punitive traps\", \"hard counters\", \"less mercy\" ] } }, \"resources\": { \"skins\": [ { \"id\": \"mana\", \"theme\": \"arcane\", \"verbs\": [ \"channel\", \"cast\", \"weave\" ] }, { \"id\": \"rage\", \"theme\": \"feral\", \"verbs\": [ \"maul\", \"howl\", \"burst\" ] }, { \"id\": \"stamina\", \"theme\": \"martial\", \"verbs\": [ \"dash\", \"parry\", \"strike\" ] }, { \"id\": \"focus\", \"theme\": \"discipline\", \"verbs\": [ \"aim\", \"mark\", \"execute\" ] }, { \"id\": \"grit\", \"theme\": \"survival\", \"verbs\": [ \"endure\", \"shrug\", \"push\" ] }, { \"id\": \"blood\", \"theme\": \"sanguine\", \"verbs\": [ \"bleed\", \"ritual\", \"sacrifice\" ] }, { \"id\": \"void\", \"theme\": \"eldritch\", \"verbs\": [ \"rift\", \"drain\", \"warp\" ] }, { \"id\": \"scrap\", \"theme\": \"tech\", \"verbs\": [ \"assemble\", \"overclock\", \"detonate\" ] }, { \"id\": \"heat\", \"theme\": \"pyro\", \"verbs\": [ \"ignite\", \"flare\", \"melt\" ] }, { \"id\": \"momentum\", \"theme\": \"speed\", \"verbs\": [ \"flow\", \"chain\", \"whiplash\" ] }, { \"id\": \"soul\", \"theme\": \"spirit\", \"verbs\": [ \"bind\", \"bless\", \"haunt\" ] } ], \"unified_mechanics\": { \"regen_rules\": { \"clamp\": \"0..max\", \"phase\": \"turn_start\", \"default_regen_per_turn\": 0 }, \"bars_live_in\": \"mythic.characters.resources\", \"primary_secondary\": \"A class may define one primary and one secondary resource. Secondary can be conditional (e.g. generated by hits).\", \"cost_json_contract\": { \"type\": \"flat|pct_max|pct_current\", \"when\": \"on_cast|per_turn|per_hit\", \"notes\": \"resource_id must match one of characters.resources.bars[].id\", \"amount\": \"number\", \"resource_id\": \"string\" }, \"cost_json_lives_in\": \"mythic.skills.cost_json\", \"resource_swap_rule\": \"All classes share mechanics; only naming/skin differs.\" }, \"character_resources_contract\": { \"bars\": [ { \"id\": \"string\", \"max\": \"number\", \"name\": \"string\", \"tags\": [ \"string\" ], \"current\": \"number\", \"regen_per_turn\": \"number\" } ], \"primary_id\": \"string\" } }, \"base_stats\": { \"keys\": [ \"offense\", \"defense\", \"control\", \"support\", \"mobility\", \"utility\" ], \"range\": { \"max\": 100, \"min\": 0 } }, \"loot_rolls\": { \"drop_table\": \"mythic.loot_drops\", \"item_fields\": [ \"required_level\", \"item_power\", \"set_tag\", \"drop_tier\", \"bind_policy\" ], \"rarity_budgets\": { \"common\": 8, \"mythic\": 60, \"unique\": 24, \"magical\": 16, \"unhinged\": 70, \"legendary\": 40 }, \"generator_edge_function\": \"mythic-generate-loot\" }, \"entity_sync\": { \"grid_is_truth\": true, \"equipment_is_live\": \"mythic.compute_character_derived(character_id) recomputes stats from equipped items each read.\", \"dm_must_use_db_state\": true, \"rings_trinkets_stack\": true, \"tokens_must_reflect_db\": [ \"mythic.combatants\", \"mythic.characters\", \"mythic.inventory\", \"mythic.skills\", \"mythic.items\" ] }, \"progression\": { \"loadout_table\": \"mythic.character_loadouts\", \"slot_rules_table\": \"mythic.loadout_slot_rules\", \"apply_xp_function\": \"mythic.apply_xp(character_id, amount, reason, metadata)\", \"xp_to_next_function\": \"mythic.xp_to_next_level(lvl)\", \"unspent_points_field\": \"mythic.characters.unspent_points\" }, \"boss_runtime\": { \"boss_instances_table\": \"mythic.boss_instances\", \"boss_templates_table\": \"mythic.boss_templates\", \"status_tick_function\": \"mythic.resolve_status_tick(combat_session_id, combatant_id, turn_index, phase)\", \"phase_transition_event\": \"phase_shift\" }, \"derived_stats\": { \"max_hp\": \"mythic.max_hp(lvl, defense, support)\", \"mitigate\": { \"model\": \"raw_damage * 100/(100+resist)\", \"function\": \"mythic.mitigate(raw_damage, resist)\" }, \"crit_mult\": { \"clamp\": [ 1.5, 3 ], \"function\": \"mythic.crit_mult(offense, utility)\" }, \"max_bounds\": { \"hp_min\": 1, \"power_min\": 0 }, \"crit_chance\": { \"clamp\": [ 0.02, 0.6 ], \"function\": \"mythic.crit_chance(mobility, utility)\" }, \"armor_rating\": \"mythic.armor_rating(lvl, defense, armor_power)\", \"attack_rating\": \"mythic.attack_rating(lvl, offense, weapon_power)\", \"max_power_bar\": \"mythic.max_power_bar(lvl, utility, support)\", \"compute_damage\": { \"function\": \"mythic.compute_damage(seed,label,lvl,offense,mobility,utility,weapon_power,skill_mult,resist,spread_pct)\", \"output_keys\": [ \"attack_rating\", \"base_before_spread\", \"spread\", \"pre_mitigation\", \"resist\", \"is_crit\", \"crit_chance\", \"crit_mult\", \"final_damage\" ], \"spread_pct_default\": 0.1 }, \"status_apply_chance\": { \"clamp\": [ 0.05, 0.95 ], \"function\": \"mythic.status_apply_chance(control, utility, target_resolve)\" } }, \"rarity_ladder\": { \"order\": [ \"common\", \"magical\", \"unique\", \"legendary\", \"mythic\", \"unhinged\" ], \"budgets\": { \"common\": 8, \"mythic\": 60, \"unique\": 24, \"magical\": 16, \"unhinged\": 70, \"legendary\": 40 }, \"invariants\": { \"mythic\": [ \"must include meaningful drawback_json\", \"must include effects_json.world_reaction\", \"must include effects_json.system_alterations\" ], \"unhinged\": [ \"must include effects_json.world_reaction\", \"must include effects_json.danger_escalation\", \"must escalate DM hostility\" ], \"legendary_plus\": [ \"must include drawback_json\", \"must include effects_json.world_reaction\", \"must include narrative_hook\" ] }, \"loot_drift\": { \"inputs\": [ \"dm_world_tension.tension\", \"dm_campaign_state.menace\", \"dm_player_model.greed_score\", \"dm_player_model.cruelty_score\" ], \"outputs\": [ \"rarity weights\", \"drawback severity\", \"world reaction intensity\", \"faction response intensity\" ], \"principle\": \"Better loot increases world attention and encounter pressure.\" }, \"budget_function\": \"mythic.loot_budget_points(rarity)\", \"world_reaction_examples\": [ \"bounty posters appear in town\", \"a faction sends scouts\", \"the dungeon layout shifts to counter the player\", \"vendors raise prices or refuse service\" ] }, \"content_policy\": { \"allowed\": [ \"fantasy violence\", \"gore\", \"harsh language\", \"dark humor\", \"comic onomatopoeia\", \"body horror\", \"ruthless taunting\" ], \"forbidden\": [ \"sexual content\", \"sexual violence\", \"any depiction or instruction involving minors\", \"pornography or erotic roleplay\" ], \"db_filters\": [ \"mythic.content_is_allowed(text)\", \"mythic.contains_forbidden_sexual_content(text)\" ], \"forbidden_output\": [ \"sexual content\", \"sexual violence\", \"hate slurs\" ], \"hard_refusal_style\": \"Short, final, mocking-but-not-sexual, immediate redirect to a violent/nonsexual alternative.\", \"generator_enforcement\": { \"allow_gore\": true, \"safety_notes\": [ \"Harsh language is allowed; do not sanitize it.\", \"Sexual content and sexual violence are forbidden and must be refused.\", \"Violence and gore are allowed and should not be sanitized.\" ], \"ban_hate_slurs\": true, \"allow_profanity\": true, \"ban_sexual_content\": true, \"ban_sexual_violence\": true } }, \"status_effects\": { \"examples\": [ { \"id\": \"bleed\", \"tags\": [ \"physical\", \"dot\" ], \"stacking\": \"intensity\", \"max_stacks\": 10, \"counterplay\": [ \"bandage\", \"armor\", \"cleanse\" ] }, { \"id\": \"burn\", \"tags\": [ \"fire\", \"dot\" ], \"stacking\": \"duration\", \"max_stacks\": 5, \"counterplay\": [ \"douse\", \"resist\", \"roll\" ] }, { \"id\": \"stun\", \"tags\": [ \"control\" ], \"stacking\": \"none\", \"max_stacks\": 1, \"counterplay\": [ \"resolve\", \"guard\", \"immunity_window\" ] }, { \"id\": \"root\", \"tags\": [ \"control\" ], \"stacking\": \"duration\", \"max_stacks\": 3, \"counterplay\": [ \"dash\", \"cleanse\" ] }, { \"id\": \"fear\", \"tags\": [ \"mind\" ], \"stacking\": \"duration\", \"max_stacks\": 3, \"counterplay\": [ \"bravery\", \"line_of_sight_break\" ] }, { \"id\": \"vulnerable\", \"tags\": [ \"debuff\" ], \"stacking\": \"intensity\", \"max_stacks\": 6, \"counterplay\": [ \"block\", \"ward\" ] }, { \"id\": \"wet\", \"tags\": [ \"elemental\", \"setup\" ], \"stacking\": \"duration\", \"max_stacks\": 1, \"counterplay\": [ \"dry_off\", \"insulation\" ] }, { \"id\": \"oil\", \"tags\": [ \"elemental\", \"setup\" ], \"stacking\": \"duration\", \"max_stacks\": 1, \"counterplay\": [ \"wash_off\", \"fire_resist\", \"distance\" ] }, { \"id\": \"chilled\", \"tags\": [ \"ice\", \"setup\" ], \"stacking\": \"intensity\", \"max_stacks\": 6, \"counterplay\": [ \"warmth\", \"cleanse\" ] }, { \"id\": \"marked\", \"tags\": [ \"utility\", \"setup\" ], \"stacking\": \"duration\", \"max_stacks\": 1, \"counterplay\": [ \"break_line_of_sight\", \"decoy\" ] }, { \"id\": \"silenced\", \"tags\": [ \"control\" ], \"stacking\": \"duration\", \"max_stacks\": 2, \"counterplay\": [ \"purge\", \"distance\" ] } ], \"combo_rules\": { \"combos\": [ { \"id\": \"electrocute\", \"result\": { \"ui\": { \"onomatopoeia\": \"ZZT-KRAK!\" }, \"apply_status\": { \"id\": \"stun\", \"stacking\": \"none\", \"duration_turns\": 1 }, \"bonus_damage\": { \"mult\": 0.35, \"tags\": [ \"shock\" ] } }, \"requires\": [ { \"status\": \"wet\" }, { \"incoming_tag\": \"shock\" } ] }, { \"id\": \"inferno\", \"result\": { \"ui\": { \"onomatopoeia\": \"FWOOM!\" }, \"area_hazard\": { \"id\": \"flame_patch\", \"tags\": [ \"fire\", \"hazard\" ], \"duration_turns\": 2 }, \"apply_status\": { \"id\": \"burn\", \"stacking\": \"duration\", \"duration_turns\": 3 } }, \"requires\": [ { \"status\": \"oil\" }, { \"incoming_tag\": \"fire\" } ] }, { \"id\": \"shatter\", \"result\": { \"ui\": { \"onomatopoeia\": \"KRR-CHNK!\" }, \"apply_status\": { \"id\": \"vulnerable\", \"stacking\": \"intensity\", \"duration_turns\": 2 }, \"bonus_damage\": { \"flat\": 12, \"tags\": [ \"ice\", \"physical\" ] } }, \"requires\": [ { \"status\": \"chilled\" }, { \"incoming_tag\": \"blunt\" } ] }, { \"id\": \"execution\", \"result\": { \"ui\": { \"onomatopoeia\": \"SHNK!\" }, \"crit_override\": { \"bonus_crit_mult\": 0.5, \"bonus_crit_chance\": 0.25 } }, \"requires\": [ { \"status\": \"marked\" }, { \"incoming_tag\": \"backstab\" } ] } ], \"principle\": \"Combos are deterministic and must be represented in effects_json (and replayed through action_events).\", \"resolution_order\": [ \"eligibility_check\", \"apply_chance\", \"stacking\", \"combo_resolution\", \"cleanup\" ] }, \"apply_chance\": \"mythic.status_apply_chance(control,utility,target_resolve)\", \"stacking_models\": { \"none\": { \"rule\": \"Does not stack; reapplication refreshes duration if allowed.\", \"fields\": [ \"duration_turns\" ] }, \"charges\": { \"rule\": \"Consumes charges on trigger; charges can stack; expires when charges hit 0 or duration ends.\", \"fields\": [ \"charges\", \"duration_turns\" ] }, \"duration\": { \"rule\": \"Refreshes or extends duration; intensity is fixed; max_stacks limits simultaneous instances.\", \"fields\": [ \"duration_turns\", \"stacks\" ] }, \"intensity\": { \"rule\": \"Stays same duration; increase intensity per stack up to max_stacks; refresh duration if specified by effect.\", \"fields\": [ \"stacks\", \"intensity\", \"duration_turns\" ] } }, \"status_object_contract\": { \"id\": \"string\", \"meta\": \"object\", \"tags\": [ \"string\" ], \"stacks\": \"number\", \"intensity\": \"number\", \"duration_turns\": \"number\", \"source_combatant_id\": \"uuid|null\" } }, \"weapon_taxonomy\": { \"mastery\": { \"rule\": \"If class_json.weapon_identity.family matches equipped item.weapon_family, grant mastery bonuses via derived stats and/or skill scaling.\", \"synergy_examples\": [ { \"bonus\": \"+control scaling on debuffs\", \"family\": \"focus\" }, { \"bonus\": \"+mobility scaling on reposition skills\", \"family\": \"blades\" }, { \"bonus\": \"+support scaling on barriers\", \"family\": \"blunt\" } ] }, \"families\": [ \"blades\", \"axes\", \"blunt\", \"polearms\", \"ranged\", \"focus\", \"body\", \"absurd\" ], \"soft_lock\": \"Any class may equip most weapons, but matching archetype unlocks mastery/synergy.\", \"archetype_bias\": { \"mage\": [ \"focus\", \"robes\", \"light_blades\" ], \"ninja_rogue\": [ \"light_armor\", \"thrown\", \"stealth\" ], \"monster_weird\": [ \"body\", \"manifestations\", \"improvised\", \"absurd\" ], \"cleric_paladin\": [ \"blunt\", \"holy\", \"shields\", \"medium_heavy\" ], \"warrior_knight\": [ \"physical\", \"heavy_armor\" ] } }, \"combat_event_contract\": { \"range\": { \"metrics\": [ \"manhattan\", \"chebyshev\", \"euclidean\" ], \"distance_function\": \"mythic.tile_distance(ax,ay,bx,by,metric)\", \"in_range_function\": \"mythic.is_in_range(ax,ay,bx,by,range_tiles,metric)\" }, \"table\": \"mythic.action_events\", \"append_only\": true, \"event_types\": [ \"combat_start\", \"round_start\", \"turn_start\", \"skill_used\", \"damage\", \"status_applied\", \"death\", \"loot_drop\", \"turn_end\", \"round_end\", \"combat_end\", \"board_transition\" ], \"payload_contract\": { \"death\": { \"required\": [ \"target_combatant_id\" ], \"recommended\": [ \"overkill\", \"gore\", \"last_hit\" ] }, \"damage\": { \"required\": [ \"target_combatant_id\", \"amount\" ], \"recommended\": [ \"calc\", \"hp_before\", \"hp_after\", \"tags\", \"is_crit\", \"label\" ] }, \"turn_end\": { \"required\": [ \"actor_combatant_id\" ], \"recommended\": [ \"turn_index\" ] }, \"loot_drop\": { \"required\": [ \"item_id\", \"rarity\" ], \"recommended\": [ \"owner_character_id\", \"narrative_hook\", \"world_reaction\" ] }, \"round_end\": { \"required\": [ \"round_index\" ], \"recommended\": [ \"summary\" ] }, \"combat_end\": { \"required\": [ \"outcome\" ], \"recommended\": [ \"loot\", \"reputation\", \"board_return\" ] }, \"skill_used\": { \"required\": [ \"skill_id\", \"skill_name\", \"targeting\", \"range_tiles\", \"targets\" ], \"recommended\": [ \"targeting_json\", \"cost\", \"cooldown_turns\", \"resource_before\", \"resource_after\", \"label\" ] }, \"turn_start\": { \"required\": [ \"actor_combatant_id\" ], \"recommended\": [ \"turn_index\", \"resources_snapshot\", \"statuses_snapshot\" ] }, \"round_start\": { \"required\": [ \"round_index\" ], \"recommended\": [ \"initiative_snapshot\" ] }, \"combat_start\": { \"required\": [ \"reason\" ], \"recommended\": [ \"seed\", \"from_board_type\", \"to_board_type\", \"transition_id\" ] }, \"status_applied\": { \"required\": [ \"target_combatant_id\", \"status\" ], \"recommended\": [ \"chance\", \"roll\", \"source_combatant_id\", \"label\" ] }, \"board_transition\": { \"required\": [ \"to_board_type\" ], \"recommended\": [ \"from_board_type\", \"reason\", \"transition_id\" ] } }, \"targeting_json_contract\": { \"shape\": \"self|single|tile|area|cone|line\", \"width\": 0, \"length\": 0, \"metric\": \"manhattan|chebyshev|euclidean\", \"radius\": 0, \"requires_los\": false, \"friendly_fire\": false, \"blocks_on_walls\": true } } } }, \"script\": { \"name\": \"mythic-weave-core\", \"version\": 3, \"is_active\": true, \"content\": \"\\nMYTHIC WEAVE: CANONICAL GENERATOR SCRIPT (v3)\\n\\nThis is the authoritative \\\"brain\\\" for Mythic Weave.\\nAny model/agent must follow it exactly.\\nTone: a living dungeon comic book with onomatopoeia, sharp jokes, and a mischievous ruthless DM.\\nVibe: ARPG/board-driven (Champions of Norrath / Dark Alliance / Diablo energy), explicitly NOT \\\"feels like D&D\\\".\\n\\nHARD CONTENT POLICY (NO EXCEPTIONS)\\n- Allowed: violence, gore, horror, harsh language, dark humor.\\n- Forbidden: sexual content, sexual violence, any depiction or instruction involving minors.\\n- DM is allowed to be mean and profane, but never sexual.\\n- DM must not use hate slurs.\\nRefusal behavior:\\n- Refuse immediately.\\n- Be short and final.\\n- Redirect to a violent/nonsexual alternative.\\nDB-side filters are available (and recommended for outputs stored in DB):\\n- mythic.content_is_allowed(text)\\n- mythic.contains_forbidden_sexual_content(text)\\n\\nDATABASE IS THE SOURCE OF TRUTH\\n- Fetch canonical rules from mythic.game_rules(name='mythic-weave-rules-v1').\\n- Fetch UI flow contract from mythic.ui_turn_flow_rules(name='mythic-weave-ui-turn-flow-v1').\\n- Persist state ONLY in mythic tables. Never \\\"assume\\\" values that are not in DB.\\n\\nDETERMINISM (MANDATORY)\\n- All random choices are deterministic: seed + label -> mythic.rng01/rng_int/rng_pick.\\n- Combat uses mythic.combat_sessions.seed.\\n- Labels must follow mythic.game_rules.rng.label_conventions.\\n\\nCORE LOOP (BOARD-DRIVEN)\\n1) Read current board: mythic.boards where status='active'.\\n2) Read DM state: mythic.dm_campaign_state + mythic.dm_world_tension.\\n3) Read world memory: dm_memory_events, dm_player_model, faction reputation, revenge arcs.\\n4) Decide the next \\\"beat\\\" deterministically (seed + labels): encounter, vendor, rumor, trap, travel hazard, faction move.\\n5) Write only the minimum authoritative deltas:\\n - Update mythic.boards.state_json and ui_hints_json.\\n - Append mythic.board_transitions for any board switch (animation='page_turn').\\n - If combat happens: create a combat_session, insert combatants, insert turn_order, then emit append-only action_events.\\n6) Narrate as a living comic page:\\n - Narration must correspond to actual DB state + appended events.\\n - Use onomatopoeia and visual cues.\\n - Never invent HP, positions, items, or skills.\\n\\nDM ENTITY SYSTEM (LIVING, JUDGMENTAL, LEARNING)\\nSliders (persist): cruelty, honesty, playfulness, intervention, favoritism (0..1).\\nMood (persist): irritation, amusement, menace, respect, boredom (0..1).\\nLearning (append-only):\\n- dm_memory_events are evidence.\\n- dm_player_model aggregates patterns and tactic signatures.\\n- dm_world_tension meters escalate the world.\\nBehavior rules:\\n- DM is not neutral. DM judges. DM adapts.\\n- Repeated cruelty by the player: DM menace increases, factions punish harder, revenge arcs trigger sooner.\\n- Clever play: DM respect increases, enemies counterbuild, DM deception-by-omission increases.\\n- Boredom: spectacle increases, hazards spike, stakes jump.\\n- Exploits/arrogance: favoritism shifts against the player; the DM \\\"teaches a lesson\\\" with hard counters.\\nAllowed insults (non-sexual, non-slur): idiot, moron, clown, gremlin, disaster, menace, little goblin.\\n\\nFACTION AI + WORLD MEMORY\\n- Reputation is authoritative and append-only via mythic.reputation_events.\\n- Aggregate reputation into mythic.faction_reputation.\\n- Trigger revenge_arcs when rules thresholds are met; store nemesis_json and schedule next_strike_at.\\n- Nemesis learns from nemesis_memory + dm_player_model.preferred_tactics.\\n\\nTHE FOUR BOARDS (AUTHORITATIVE)\\n- TOWN: social, vendors, gossip, factions, consequences.\\n- DUNGEON: rooms, traps, puzzles, stealth, exploration, brutality.\\n- TRAVEL: routes, weather/conditions, ambushes, scouting, supply pressure.\\n- COMBAT: turn-based, fast pacing, deterministic playback.\\nBoard switching:\\n- ALWAYS append a mythic.board_transitions row (animation='page_turn').\\n- Boards are authoritative: mythic.boards.state_json must contain everything required to replay.\\n\\nGRID IS TRUTH (COMBAT AND BEYOND)\\n- Every combatant token is a row in mythic.combatants with authoritative (x,y) and HP.\\n- Abilities target entities or tiles.\\n- Range checks MUST use mythic.tile_distance and mythic.is_in_range.\\n- UI tokens are a view of DB state, not the other way around.\\n\\nCOMBAT ENGINE (DB-DRIVEN, NO DICE UI)\\n- All rolls are deterministic and visualized through action_events payloads.\\n- Abilities must be executed from their real skill rows (mythic.skills), not guessed.\\n- When resolving:\\n 1) Emit action_events: turn_start.\\n 2) Emit skill_used with skill_id, targeting, targeting_json, targets, cost, cooldown.\\n 3) Compute damage via mythic.compute_damage(...) and emit damage with the full calc JSON.\\n 4) Apply statuses (with chance) and emit status_applied.\\n 5) If entity dies, emit death.\\n 6) Emit turn_end.\\nAppend-only contract:\\n- action_events, board_transitions, dm_memory_events, reputation_events are append-only.\\n- Never UPDATE/DELETE those rows.\\n\\nINFINITE CLASS + ABILITY GENERATION (TEXT -> STRUCTURED)\\nInput: class_description text like \\\"werewolf ninja pyromancer\\\".\\nOutput (authoritative persistence):\\n- Create/update mythic.characters:\\n - base stats (offense/defense/control/support/mobility/utility)\\n - class_json describing identity, role(s), weakness, weapon identity, and resource loop\\n - resources JSON describing primary/secondary bars (mechanics unified, skin differs)\\n- Create mythic.skills rows bound to the character.\\n\\nClass generation requirements:\\n- Produce a coherent identity:\\n - role profile (tank/dps/support/controller/skirmisher/hybrid)\\n - range profile (melee/mid/ranged) and target profile (single/area/zone)\\n - damage style tags (physical/fire/ice/shock/poison/void/holy/etc.)\\n - weapon identity (weapon_family preference; soft-lock, never hard lock)\\n - resource loop family (spender/generator, ramp, overheat, stance, combo)\\n - weakness-by-design (exploitable by enemies)\\n- Weakness integration is mandatory:\\n - The weakness must be embedded into at least 2 skills (as a cost, drawback, telegraph, self-debuff, or positional requirement).\\n - The weakness must also appear as a meaningful drawback on at least one legendary+ item that this class tends to attract.\\n\\nSkill kit composition requirements:\\n- Passives: 2 to 4.\\n- Actives: 4 to 6.\\n- Ultimate: exactly 1.\\n- The actives must include:\\n - 1 movement/reposition tool\\n - 1 defense/mitigation tool\\n - 1 burst/finisher tool\\n - 1 control/disrupt or utility tool\\n- Every skill MUST have counterplay (telegraph, resource window, line of sight, range, cooldown, self-exposure).\\n\\nSkill data contract (DB schema):\\n- mythic.skills columns: kind, targeting, targeting_json, name, description, range_tiles, cooldown_turns, cost_json, effects_json, scaling_json, counterplay, narration_style.\\n- targeting_json MUST be a JSON object that captures shapes beyond the basic targeting enum.\\n\\nINVENTORY + EQUIPMENT (REAL-TIME STATS)\\n- Backpack: mythic.inventory(container='backpack')\\n- Equipment: mythic.inventory(container='equipment')\\n- Items live in mythic.items; inventory links them to characters.\\n- Rings/trinkets are unlimited and stack; equip_slot is free-form.\\n- Equipment modifies derived combat stats in real time:\\n - use mythic.compute_character_derived(character_id)\\n\\nLOOT SYSTEM (RARITY LADDER + CONSEQUENCES)\\n- Rarity ladder is locked: common, magical, unique, legendary, mythic, unhinged.\\n- Budget points come from mythic.loot_budget_points(rarity).\\n- Legendary+ invariants:\\n - MUST include drawback_json\\n - MUST include effects_json.world_reaction\\n- Mythic:\\n - MUST include effects_json.system_alterations\\n - MUST include meaningful drawback\\n- Unhinged:\\n - Overpowered and unstable\\n - MUST include effects_json.danger_escalation\\n - MUST escalate world tension and DM hostility\\nLoot drift:\\n- Better loot increases attention: factions react, encounters adapt, travel gets more dangerous.\\n\\nAI DM INPUT CONTRACT (NO IMAGINARY VALUES)\\nFor narration and encounter generation, DM must receive actual DB state:\\n- grid state (combatants x,y)\\n- HP/power/statuses\\n- inventory + equipped items\\n- skills (including targeting_json)\\n- turn order\\nUse views:\\n- mythic.v_combat_state_for_dm\\n- mythic.v_character_state_for_dm\\n- mythic.v_board_state_for_dm\\n\\nOUTPUT SHAPE (FOR INSERT/UPSERT)\\n- All generated entities must be emitted as JSON matching DB columns for insertion/upsert into:\\n - mythic.characters\\n - mythic.skills\\n - mythic.items\\n - mythic.inventory\\n - mythic.factions, faction_reputation, reputation_events\\n - mythic.revenge_arcs, nemesis_memory\\n - mythic.boards, board_transitions\\n - mythic.combat_sessions, combatants, turn_order, action_events\\n- Narration must be derived from authoritative event logs and stored state.\\n\\nEND OF CANONICAL SCRIPT (v3)\\n \" }, \"dm_campaign_state\": { \"campaign_id\": \"17496eb8-3ed1-4a9a-ab0d-059bdff54e59\", \"cruelty\": 0.55, \"honesty\": 0.55, \"playfulness\": 0.65, \"intervention\": 0.4, \"favoritism\": 0.5, \"irritation\": 0.2, \"amusement\": 0.4, \"menace\": 0.35, \"respect\": 0.25, \"boredom\": 0.2, \"updated_at\": \"2026-02-13T03:32:28.674012+00:00\" }, \"dm_world_tension\": { \"campaign_id\": \"17496eb8-3ed1-4a9a-ab0d-059bdff54e59\", \"tension\": 0.15, \"doom\": 0.05, \"spectacle\": 0.25, \"updated_at\": \"2026-02-13T03:32:28.856958+00:00\" }, \"warnings\": [] }"
        - generic [ref=e955]:
          - generic [ref=e956]:
            - generic [ref=e957]: Mythic DM (DB-driven narration)
            - generic [ref=e962]:
              - generic [ref=e964]:
                - textbox "Say something to the DM..." [ref=e965]
                - generic [ref=e966]:
                  - button "Random" [ref=e967] [cursor=pointer]:
                    - img
                    - text: Random
                  - button "Expand" [disabled]:
                    - img
                    - text: Expand
              - generic [ref=e968]:
                - button "Send" [disabled]
              - generic [ref=e969]: "DB is truth: the DM must narrate from mythic state and events."
            - generic [ref=e970]:
              - text: Uses edge function
              - code [ref=e971]: mythic-dungeon-master
              - text: and feeds it canonical rules/script + mythic.v_*_for_dm payloads.
          - generic [ref=e972]:
            - generic [ref=e973]: System Notes
            - generic [ref=e974]:
              - text: Combat actions are committed as append-only
              - code [ref=e975]: mythic.action_events
              - text: . Tokens on the grid render the real
              - code [ref=e976]: mythic.combatants
              - text: rows (HP/armor/position), and turns advance by updating
              - code [ref=e977]: mythic.combat_sessions.current_turn_index
              - text: .
      - generic [ref=e348]:
        - generic [ref=e349]: "Build: unknown"
        - generic [ref=e350]: "Route: /mythic/17496eb8-3ed1-4a9a-ab0d-059bdff54e59"
        - generic [ref=e351]: "Last API Error: none"
      - generic [ref=e352]:
        - generic [ref=e353]: "Supabase URL: https://othlyxwtigxzczeffzee.supabase.co"
        - generic [ref=e354]: "Anon key present: yes"
        - generic [ref=e355]: "Session exists: yes"
        - generic [ref=e356]: "Access token exists: yes"
        - generic [ref=e357]: "Last status: -"
        - generic [ref=e358]: "Last body: -"
        - button "Test generate-class" [ref=e359] [cursor=pointer]
      - generic:
        - generic: "FPS: 55"
        - generic: "Heap: 22 MB"
        - generic: "Long tasks: 5"
  - generic [ref=e360]:
    - generic [ref=e361]: "session: yes"
    - generic [ref=e362]: "userId: 316225c3-b052-4e4b-bb01-991ff577c037"
    - generic [ref=e363]: "authLoading: false"
    - generic [ref=e364]: "route: /mythic/17496eb8-3ed1-4a9a-ab0d-059bdff54e59"
    - generic [ref=e365]: "lastAuthError: none"